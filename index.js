let ws = require("ws");let WebSocket = ws.Server;let server = new WebSocket({port:9090});let sessions = new Set();server.on("connection",session=>{    session.id=++sessions.size;    sessions.add(session);    session.on("message",message=>{        var msg = JSON.parse(message);        if(msg.type == "login"){            session.username = msg.username;            let _msg = {                type:"login",                msg:`${msg.username}加入聊天`,                username:session.username            };            sessions.forEach(sess=>{                sess.send(JSON.stringify(_msg));            });        }        if(msg.type == "sendMsg"){            sessions.forEach(sess=>{                let _msg = {                    type:"msg",                  msg:msg.msg,                  username:session.username                };                sess.send(JSON.stringify(_msg));            });        }    });    session.on("close",_=>{        let _msg = {            type:"login",            msg:`${session.username}退出了聊天`,            username:session.username        };        sessions.forEach(sess => {            sess.send(JSON.stringify(_msg));        });        sessions.delete(session);    })});